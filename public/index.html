<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Traveller Combat VTT - Multiplayer Mode</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>âš”ï¸ Traveller Combat VTT</h1>
      <div class="stage">MULTIPLAYER MODE - STAGE 11 COMPLETE</div>

      <!-- Player indicator - shows clearly which player you are -->
      <div class="player-indicator" id="player-indicator">
        <div class="player-badge">
          <span class="player-icon">ğŸ‘¤</span>
          <span id="player-number">Connecting...</span>
        </div>
        <div class="player-ship" id="player-ship-name">No ship assigned</div>
      </div>
    </div>

    <!-- Stage 8.6: Ship Selection Screen -->
    <div id="ship-selection-screen">
      <div class="card">
        <h2>ğŸš€ Select Your Spacecraft</h2>

        <div class="mode-info">
          <strong>ğŸ® MULTIPLAYER MODE:</strong> Open this URL in TWO browser tabs to play against yourself, or share with a friend!<br>
          <em>Instructions:</em> (1) Select a ship, (2) Choose starting range, (3) Click "Ready" button
        </div>

        <div class="ship-selection-grid">
          <div class="ship-option" id="ship-option-scout" data-ship="scout">
            <div class="ship-option-header">âš¡ Scout</div>
            <div class="ship-option-type">Type-S Scout/Courier</div>
            <div class="ship-option-stats">
              <div>Hull: <strong>40</strong></div>
              <div>Armour: <strong>4</strong></div>
              <div>Thrust: <strong>2</strong></div>
              <div>Turrets: <strong>1</strong></div>
            </div>
            <div class="ship-option-description">
              Fast exploration vessel with triple turret (pulse laser, sandcaster, missiles)
            </div>
          </div>

          <div class="ship-option" id="ship-option-free_trader" data-ship="free_trader">
            <div class="ship-option-header">ğŸ“¦ Free Trader</div>
            <div class="ship-option-type">Type-A Free Trader</div>
            <div class="ship-option-stats">
              <div>Hull: <strong>80</strong></div>
              <div>Armour: <strong>2</strong></div>
              <div>Thrust: <strong>1</strong></div>
              <div>Turrets: <strong>2</strong></div>
            </div>
            <div class="ship-option-description">
              Versatile merchant vessel with dual beam laser turrets
            </div>
          </div>
        </div>

        <div class="range-selection">
          <label for="range-select">Starting Range:</label>
          <select id="range-select">
            <option value="Adjacent">Adjacent</option>
            <option value="Close">Close</option>
            <option value="Short" selected>Short</option>
            <option value="Medium">Medium</option>
            <option value="Long">Long</option>
            <option value="Very Long">Very Long</option>
            <option value="Distant">Distant</option>
          </select>
        </div>

        <div class="ready-section">
          <div class="ready-indicators">
            <div class="ready-indicator waiting" id="player-ready-indicator">
              â± You: Select ship and range above
            </div>
            <div class="ready-indicator waiting" id="opponent-ready-indicator">
              â± Opponent: Waiting to connect...
            </div>
          </div>
          <button id="ready-button" disabled>Ready</button>
        </div>

        <div id="ready-status" style="text-align: center; margin-top: 15px; font-size: 14px; color: #ffa500;"></div>
      </div>
    </div>

    <!-- Stage 8.7: Space Combat HUD -->
    <div id="space-combat-hud" style="display: none;">
      <!-- Compact Ship Status HUD -->
      <div class="card">
        <div class="hud-top">
          <div class="hud-ship-info">
            <div class="hud-ship-name" id="ship-name">Scout</div>
            <div class="hud-ship-type">Type-S Scout/Courier</div>
            <div class="hud-player-info">
              <span class="player-icon">ğŸ‘¤</span>
              <span id="combat-player-number"></span>
              <span class="player-separator">â€¢</span>
              <span id="combat-player-ship"></span>
            </div>
          </div>
          <div class="hud-stats">
            <div class="hud-stat">
              <span class="hud-stat-label">Armour:</span>
              <span class="hud-stat-value" id="ship-armour">4</span>
            </div>
            <div class="hud-stat">
              <span class="hud-stat-label">Range:</span>
              <span class="hud-stat-value" id="current-range">Short</span>
            </div>
            <div class="hud-stat">
              <span class="hud-stat-label">Round:</span>
              <span class="hud-stat-value" id="round-counter">1</span>
            </div>
          </div>
        </div>

        <div class="hud-hull-section">
          <div class="hud-hull-label">
            Hull: <span id="hull-current">40</span> / <span id="hull-max">40</span>
          </div>
          <div class="hud-hull-bar">
            <div class="hud-hull-fill" id="hull-bar-fill" style="width: 100%;"></div>
          </div>
        </div>

        <div class="hud-initiative" id="initiative-display">
          <span class="initiative-label">Initiative:</span>
          <span class="initiative-value" id="initiative-value">Calculating...</span>
        </div>
      </div>

      <!-- Turn/Phase Tracker -->
      <div class="card">
        <div class="turn-tracker">
          <div id="turnIndicator" class="turn-indicator waiting">
            <div id="turnStatus" class="turn-status">â³ Waiting for game to start...</div>
            <div id="roundDisplay" class="round-display">Click "Ready" when both players are connected</div>
          </div>
        </div>
      </div>

      <!-- Crew Panel (Collapsible) -->
      <div class="card">
        <div class="crew-panel-header" id="crew-panel-toggle">
          <h3>ğŸ‘¥ Crew</h3>
          <span class="collapse-icon">â–¼</span>
        </div>
        <div class="crew-panel-content" id="crew-panel-content">
          <div id="crew-panel">
            <div class="crew-role">
              <span class="role-name">Pilot:</span>
              <span class="crew-name">Miller (Skill +2)</span>
            </div>
            <div class="crew-role">
              <span class="role-name">Gunner:</span>
              <span class="crew-name">Chen (Skill +1)</span>
              <span class="turret-assignment">Turret 1</span>
            </div>
            <div class="crew-role" id="turret-2-crew" style="display: none;">
              <span class="role-name">Turret 2:</span>
              <span class="crew-name">Automated (Skill 0)</span>
              <span class="turret-assignment">Any gunner/Captain</span>
            </div>
            <div class="crew-role">
              <span class="role-name">Engineer:</span>
              <span class="crew-name">Rodriguez (Skill +1)</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Gunner Actions -->
      <div class="card">
        <h3>ğŸ¯ Gunner Actions</h3>
        <div class="gunner-controls">
          <div class="gunner-controls-row">
            <div class="control-group">
              <label for="turret-select">Turret:</label>
              <select id="turret-select">
                <option value="0">Turret 1 (Triple)</option>
              </select>
            </div>
            <div class="control-group">
              <label for="target-select">Target:</label>
              <select id="target-select">
                <option value="opponent">Enemy Ship</option>
              </select>
            </div>
            <div class="control-group">
              <label for="weapon-select">Weapon:</label>
              <select id="weapon-select">
                <option value="0">Pulse Laser (2d6)</option>
                <option value="1">Sandcaster (Defense)</option>
                <option value="2">Missiles (4d6, 6 shots)</option>
              </select>
            </div>
          </div>
          <button id="fire-button" class="fire-button" disabled>ğŸ”¥ FIRE!</button>

          <!-- STAGE 11: Missile/Sandcaster Actions -->
          <div class="weapon-actions" style="margin-top: 15px; display: flex; gap: 10px;">
            <button id="launch-missile-button" class="action-button" disabled>ğŸš€ Launch Missile</button>
            <button id="point-defense-button" class="action-button" disabled>ğŸ¯ Point Defense</button>
            <button id="use-sandcaster-button" class="action-button" disabled>ğŸ’¨ Use Sandcaster</button>
          </div>

          <!-- STAGE 11: Ammo Display -->
          <div class="ammo-display" style="margin-top: 10px; font-size: 0.9em; color: #666;">
            <span id="missiles-remaining">Missiles: 12</span> |
            <span id="sandcaster-remaining">Sand: 20</span>
          </div>
        </div>
      </div>

      <!-- Turn Management -->
      <div class="card">
        <div class="turn-management">
          <div class="turn-timer-display">
            <span class="timer-label">Turn Timer:</span>
            <span class="timer-value" id="turn-timer">30s</span>
          </div>
          <div class="turn-buttons">
            <button id="use-default-button" class="action-button">âš¡ Use Default</button>
            <button id="end-turn-button" class="action-button primary">âœ… End Turn</button>
          </div>
        </div>
      </div>

      <!-- Combat Log -->
      <div class="card">
        <h3>ğŸ“œ Combat Log</h3>
        <div class="combat-log" id="combat-log">
          <div class="log-entry system">Waiting for combat to begin...</div>
        </div>
      </div>

      <!-- Player Feedback -->
      <div class="card" style="margin-top: 20px;">
        <details>
          <summary style="cursor: pointer; font-weight: bold; padding: 10px;">ğŸ’¬ Provide Feedback</summary>
          <div style="padding: 10px;">
            <p style="font-size: 0.9em; color: #666; margin-bottom: 10px;">
              Help improve the game! Share bugs, suggestions, or comments.
            </p>
            <textarea
              id="feedback-text"
              placeholder="Enter your feedback here..."
              style="width: 100%; height: 80px; padding: 8px; border: 1px solid #ccc; border-radius: 4px; resize: vertical;"
            ></textarea>
            <button
              id="submit-feedback-button"
              class="action-button"
              style="margin-top: 10px;"
            >
              ğŸ“¤ Submit Feedback
            </button>
            <div id="feedback-status" style="margin-top: 10px; font-size: 0.9em;"></div>
          </div>
        </details>
      </div>

      <!-- Version Display -->
      <div style="text-align: center; margin-top: 20px; padding: 15px; font-size: 0.85em; color: #888; border-top: 1px solid #333;">
        <div style="margin-bottom: 5px;">Traveller Combat VTT</div>
        <div><strong>Version 0.11</strong> - Released 2025-11-11</div>
        <div style="margin-top: 5px; font-size: 0.9em;">Stage 11: Missiles and Sandcasters Complete</div>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="app.js"></script>
</body>
</html>
